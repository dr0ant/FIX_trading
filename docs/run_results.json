{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.2", "generated_at": "2025-07-05T06:12:29.938036Z", "invocation_id": "57b61cce-cd1b-4a42-8161-53e1299c2daa", "invocation_started_at": "2025-07-05T06:12:29.105827Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.907373Z", "completed_at": "2025-07-05T06:12:29.915747Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.916158Z", "completed_at": "2025-07-05T06:12:29.916165Z"}], "thread_id": "Thread-1", "execution_time": 0.010293006896972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.dim_fix_message_types", "compiled": true, "compiled_code": "\n\nSELECT '0' AS msg_type, 'Heartbeat' AS msg_type_description\nUNION ALL SELECT '1', 'Test Request'\nUNION ALL SELECT '2', 'Resend Request'\nUNION ALL SELECT '3', 'Reject'\nUNION ALL SELECT '4', 'Sequence Reset'\nUNION ALL SELECT '5', 'Logout'\nUNION ALL SELECT '6', 'Indication of Interest'\nUNION ALL SELECT '7', 'Advertisement'\nUNION ALL SELECT '8', 'Execution Report'\nUNION ALL SELECT '9', 'Order Cancel Reject'\nUNION ALL SELECT 'A', 'Logon'\nUNION ALL SELECT 'D', 'New Order Single'\nUNION ALL SELECT 'E', 'New Order List'\nUNION ALL SELECT 'F', 'Order Cancel Request'\nUNION ALL SELECT 'G', 'Order Replacement Request'\nUNION ALL SELECT 'H', 'Order Status Request'\nUNION ALL SELECT 'J', 'Allocation'\nUNION ALL SELECT 'K', 'List Cancel Request'\nUNION ALL SELECT 'L', 'List Execute'\nUNION ALL SELECT 'M', 'List Status Request'\nUNION ALL SELECT 'N', 'List Status'\nUNION ALL SELECT 'P', 'Allocation ACK'\nUNION ALL SELECT 'Q', 'Don t Know Trade (DK)'\nUNION ALL SELECT 'R', 'Quote Request'\nUNION ALL SELECT 'S', 'Quote'\nUNION ALL SELECT 'T', 'Settlement Instructions'\nUNION ALL SELECT 'V', 'Market Data Request'\nUNION ALL SELECT 'W', 'Market Data Snapshot/Full Refresh'\nUNION ALL SELECT 'X', 'Market Data Incremental Refresh'\nUNION ALL SELECT 'Y', 'Market Data Request Reject'\nUNION ALL SELECT 'Z', 'Quote Cancel'\nUNION ALL SELECT 'a', 'Quote Status Request'\nUNION ALL SELECT 'b', 'Mass Quote Acknowledgement'\nUNION ALL SELECT 'c', 'Security Definition Request'\nUNION ALL SELECT 'd', 'Security Definition'\nUNION ALL SELECT 'e', 'Security Status Request'\nUNION ALL SELECT 'f', 'Security Status'\nUNION ALL SELECT 'g', 'Trading Session Status Request'\nUNION ALL SELECT 'h', 'Trading Session Status'\nUNION ALL SELECT 'j', 'Mass Quote'\nUNION ALL SELECT 'k', 'Business Message Reject'\nUNION ALL SELECT 'l', 'Bid Request'\nUNION ALL SELECT 'm', 'Bid Response'\nUNION ALL SELECT 'n', 'New Order Multileg'\nUNION ALL SELECT 'o', 'Multileg Order Cancel/Replace'\nUNION ALL SELECT 'p', 'Trade Capture Report Request'\nUNION ALL SELECT 'q', 'Trade Capture Report'\nUNION ALL SELECT 'r', 'Order Mass Status Request'\nUNION ALL SELECT 's', 'Quote Request Reject'\nUNION ALL SELECT 't', 'RFQ Request'\nUNION ALL SELECT 'u', 'Quote Status Report'\nUNION ALL SELECT 'v', 'Quote Response'\nUNION ALL SELECT 'w', 'Confirmation'\nUNION ALL SELECT 'x', 'Confirmation Ack'\nUNION ALL SELECT 'y', 'Confirmation Request'\nUNION ALL SELECT 'z', 'Settlement Instruction Request'\nUNION ALL SELECT 'AA', 'Assignment Report'\nUNION ALL SELECT 'AB', 'Collateral Request'\nUNION ALL SELECT 'AC', 'Collateral Assignment'\nUNION ALL SELECT 'AD', 'Collateral Response'\nUNION ALL SELECT 'AE', 'News'\nUNION ALL SELECT 'AF', 'Collateral Report'\nUNION ALL SELECT 'AG', 'Collateral Inquiry'\nUNION ALL SELECT 'AH', 'Collateral Inquiry Ack'\nUNION ALL SELECT 'AI', 'Network Counterparty System Status Request'\nUNION ALL SELECT 'AJ', 'Network Counterparty System Status Response'\nUNION ALL SELECT 'AK', 'User Request'\nUNION ALL SELECT 'AL', 'User Response'\nUNION ALL SELECT 'AM', 'Collateral Account Report'\nUNION ALL SELECT 'AN', 'Party Risk Limits Request'\nUNION ALL SELECT 'AO', 'Party Risk Limits Report'\nUNION ALL SELECT 'AP', 'Party Risk Limits Report ACK'\nUNION ALL SELECT 'AQ', 'Risk Limit Update Report'\nUNION ALL SELECT 'AR', 'Request For Positions'\nUNION ALL SELECT 'AS', 'Request For Positions Ack'\nUNION ALL SELECT 'AT', 'Position Report'\nUNION ALL SELECT 'AU', 'Request For Positions Confirm'\nUNION ALL SELECT 'AV', 'Trade Capture Report Ack'\nUNION ALL SELECT 'AW', 'Trade Capture Report Rejection'\nUNION ALL SELECT 'AX', 'Trade Capture Report Status Request'\nUNION ALL SELECT 'AY', 'Trade Capture Report Status'\nUNION ALL SELECT 'AZ', 'Security List Request'\nUNION ALL SELECT 'BA', 'Security List'\nUNION ALL SELECT 'BB', 'Security List Update Report'\nUNION ALL SELECT 'BC', 'Security Definition Update Report'\nUNION ALL SELECT 'BD', 'Adjusted Order Mass Status Request'\nUNION ALL SELECT 'BE', 'Adjusted Order Mass Status Report'\nUNION ALL SELECT 'BF', 'Adjusted Quote Report'\nUNION ALL SELECT 'BG', 'Order Mass Action Report'\nUNION ALL SELECT 'BH', 'Order Mass Action Request'\nUNION ALL SELECT 'BI', 'Order Mass Action Request ACK'\nUNION ALL SELECT 'BJ', 'Trade Capture Report Cancel'\nUNION ALL SELECT 'BK', 'Trade Capture Report Amend'\nUNION ALL SELECT 'BL', 'Trade Capture Report Replace'\nUNION ALL SELECT 'BM', 'Trade Capture Report Rejection Ack'\nUNION ALL SELECT 'BN', 'Trade Capture Report Rejection Reject'\nUNION ALL SELECT 'BO', 'Trade Capture Report Rejection Status Request'\nUNION ALL SELECT 'BP', 'Trade Capture Report Rejection Status'\nUNION ALL SELECT 'BQ', 'Trade Capture Report Query'\nUNION ALL SELECT 'BR', 'Trade Capture Report Query ACK'\nUNION ALL SELECT 'BS', 'Trade Capture Report Query Reject'\nUNION ALL SELECT 'BT', 'Trade Capture Report Query Status Request'\nUNION ALL SELECT 'BU', 'Trade Capture Report Query Status'\nUNION ALL SELECT 'BV', 'Trade Capture Report Query Status Report'\nUNION ALL SELECT 'BW', 'Trade Capture Report Query Rejection'\nUNION ALL SELECT 'BX', 'Trade Capture Report Query Rejection Ack'\nUNION ALL SELECT 'BY', 'Trade Capture Report Query Rejection Status Request'\nUNION ALL SELECT 'BZ', 'Trade Capture Report Query Rejection Status'\nUNION ALL SELECT 'CA', 'Trade Capture Report Query Rejection Status Report'\nUNION ALL SELECT 'CB', 'Trade Capture Report Query Rejection Reject'\nUNION ALL SELECT 'CC', 'Trade Capture Report Query Rejection Confirm'\nUNION ALL SELECT 'CD', 'Trade Capture Report Query Rejection Status Confirm'\nUNION ALL SELECT 'CE', 'Trade Capture Report Query Rejection Status Reject'\nUNION ALL SELECT 'CF', 'Trade Capture Report Query Rejection Status Confirm Ack'\nUNION ALL SELECT 'CG', 'Trade Capture Report Query Rejection Status Confirm Reject'\nUNION ALL SELECT 'CH', 'Trade Capture Report Query Rejection Status Confirm Status Request'\nUNION ALL SELECT 'CI', 'Trade Capture Report Query Rejection Status Confirm Status'\nUNION ALL SELECT 'CJ', 'Trade Capture Report Query Rejection Status Confirm Status Report'\nUNION ALL SELECT 'CK', 'Trade Capture Report Query Rejection Status Confirm Status Rejection'\nUNION ALL SELECT 'CL', 'Trade Capture Report Query Rejection Status Confirm Status Rejection Ack'\nUNION ALL SELECT 'CM', 'Trade Capture Report Query Rejection Status Confirm Status Rejection Status Request'\nUNION ALL SELECT 'CN', 'Trade Capture Report Query Rejection Status Confirm Status Rejection Status'\nUNION ALL SELECT 'CO', 'Trade Capture Report Query Rejection Status Confirm Status Rejection Status Report'\nUNION ALL SELECT 'CP', 'Trade Capture Report Query Rejection Status Confirm Status Rejection Status Rejection'", "relation_name": "\"duckdb_pictet\".\"main_03_analytics\".\"dim_fix_message_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.911239Z", "completed_at": "2025-07-05T06:12:29.915985Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.916496Z", "completed_at": "2025-07-05T06:12:29.916500Z"}], "thread_id": "Thread-2", "execution_time": 0.010269880294799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.dim_fix_order_statuses", "compiled": true, "compiled_code": "\n\nSELECT 39 AS tag_id, 'OrdStatus' AS field_name, '0' AS status_code, 'New' AS status_value, 'Order is new and has been accepted by the exchange/system.' AS description\nUNION ALL SELECT 39, 'OrdStatus', '1', 'Partially Filled', 'Part of the order has been executed.'\nUNION ALL SELECT 39, 'OrdStatus', '2', 'Filled', 'The order has been completely executed.'\nUNION ALL SELECT 39, 'OrdStatus', '3', 'Done for Day', 'Order is no longer active for the day.'\nUNION ALL SELECT 39, 'OrdStatus', '4', 'Canceled', 'Order has been canceled.'\nUNION ALL SELECT 39, 'OrdStatus', '5', 'Replaced', 'Order has been replaced/amended.'\nUNION ALL SELECT 39, 'OrdStatus', '6', 'Pending Cancel', 'Currently being canceled.'\nUNION ALL SELECT 39, 'OrdStatus', '7', 'Stopped', 'Order has been stopped (usually by a specialist in a manual execution market).'\nUNION ALL SELECT 39, 'OrdStatus', '8', 'Rejected', 'Order has been rejected by the exchange/system.'\nUNION ALL SELECT 39, 'OrdStatus', '9', 'Suspended', 'Order has been suspended.'\nUNION ALL SELECT 39, 'OrdStatus', 'A', 'Pending New', 'Currently being submitted.'\nUNION ALL SELECT 39, 'OrdStatus', 'B', 'Calculated', 'Quantity has been calculated.'\nUNION ALL SELECT 39, 'OrdStatus', 'C', 'Expired', 'Order has expired.'\nUNION ALL SELECT 39, 'OrdStatus', 'D', 'Accepted for Bidding', 'Order has been accepted for bidding (for use in auctions).'\nUNION ALL SELECT 39, 'OrdStatus', 'E', 'Pending Replace', 'Currently being replaced/amended.'\nUNION ALL SELECT 39, 'OrdStatus', 'F', 'Accepted for Execution', 'Order has been accepted for execution.'\nUNION ALL SELECT 39, 'OrdStatus', 'G', 'Pending Cancel/Replace', 'Currently pending cancel or replace.'\n-- Add more OrdStatus values as needed based on FIX specifications\n\nUNION ALL SELECT 150 AS tag_id, 'ExecType' AS field_name, '0' AS status_code, 'New' AS status_value, 'New order accepted.' AS description\nUNION ALL SELECT 150, 'ExecType', '1', 'Partial Fill', 'Partial execution of an order.'\nUNION ALL SELECT 150, 'ExecType', '2', 'Fill', 'Complete execution of an order.'\nUNION ALL SELECT 150, 'ExecType', '3', 'Done for Day', 'Order no longer active for the day.'\nUNION ALL SELECT 150, 'ExecType', '4', 'Canceled', 'Order has been canceled.'\nUNION ALL SELECT 150, 'ExecType', '5', 'Replace', 'Order has been replaced/amended.'\nUNION ALL SELECT 150, 'ExecType', '6', 'Pending Cancel', 'Currently being canceled.'\nUNION ALL SELECT 150, 'ExecType', '7', 'Stopped', 'Order has been stopped.'\nUNION ALL SELECT 150, 'ExecType', '8', 'Rejected', 'Order has been rejected.'\nUNION ALL SELECT 150, 'ExecType', '9', 'Suspended', 'Order has been suspended.'\nUNION ALL SELECT 150, 'ExecType', 'A', 'Pending New', 'Currently being submitted.'\nUNION ALL SELECT 150, 'ExecType', 'B', 'Calculated', 'Quantity has been calculated.'\nUNION ALL SELECT 150, 'ExecType', 'C', 'Expired', 'Order has expired.'\nUNION ALL SELECT 150, 'ExecType', 'D', 'Restated', 'Order has been restated.'\nUNION ALL SELECT 150, 'ExecType', 'E', 'Pending Replace', 'Currently being replaced/amended.'\nUNION ALL SELECT 150, 'ExecType', 'F', 'Trade', 'Order has been traded.'\nUNION ALL SELECT 150, 'ExecType', 'G', 'Trade Correct', 'Correction to a previous trade.'\nUNION ALL SELECT 150, 'ExecType', 'H', 'Trade Cancel', 'Cancellation of a previously reported trade.'\nUNION ALL SELECT 150, 'ExecType', 'I', 'Order Status', 'Status request response for an order.'\nUNION ALL SELECT 150, 'ExecType', 'J', 'Trade Confirm', 'Confirmation of a trade.'\n-- Add more ExecType values as needed based on FIX specifications", "relation_name": "\"duckdb_pictet\".\"main_03_analytics\".\"dim_fix_order_statuses\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.912719Z", "completed_at": "2025-07-05T06:12:29.916768Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.917176Z", "completed_at": "2025-07-05T06:12:29.917179Z"}], "thread_id": "Thread-3", "execution_time": 0.010429143905639648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.landing_fix", "compiled": true, "compiled_code": "\n\nSELECT\n  filename,  -- Optional: only if added manually during parsing\n  \"52\" AS timestamp,\n  \"49\" AS system,\n  \"35\" AS msg_type,\n  \"11\" AS cl_ord_id,\n  \"37\" AS order_id,\n  \"17\" AS exec_id,\n  \"150\" AS exec_type,\n  \"39\" AS ord_status,\n  \"1\"   AS account,\n  \"55\"  AS symbol,\n  \"54\"  AS side,\n  \"15\"  AS currency,\n  \"44\"  AS price,\n  \"38\"  AS quantity,\n  \"60\"  AS transact_time,\n  \"49\"  AS sender_comp_id,\n  \"56\"  AS target_comp_id,\n  \"59\"  AS time_in_force,\n  \"10\"  AS checksum,\n  \"9\"   AS body_length,\n  \"8\"   AS begin_string,\n  \"34\"  AS msg_seq_num,\n  \"52\"  AS sending_time,\n  \"526\" AS secondary_cl_ord_id\nFROM read_parquet('s3://parquetfixlogs/*.parquet')\nORDER BY \"52\"", "relation_name": "\"duckdb_pictet\".\"main_00_landing_fix\".\"fix_trading_raw\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.913965Z", "completed_at": "2025-07-05T06:12:29.916978Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.917454Z", "completed_at": "2025-07-05T06:12:29.917458Z"}], "thread_id": "Thread-4", "execution_time": 0.010324239730834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.postgres_processed_files", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM postgres_scan_pushdown('host=postgres port=5432 user=admin password=admin dbname=fix_db', 'public', 'processed_files')", "relation_name": "\"duckdb_pictet\".\"main_00_landing_external\".\"postgres_processed_files\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.918505Z", "completed_at": "2025-07-05T06:12:29.921798Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.921953Z", "completed_at": "2025-07-05T06:12:29.921956Z"}], "thread_id": "Thread-1", "execution_time": 0.003997087478637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.stg_fix_trading", "compiled": true, "compiled_code": "-- DBT LAYER: staging/landing_fix__stg_fix_trading.sql\n-- This prepares the raw FIX logs for transformation\n\n\n\n\nWITH base AS (\n  SELECT\n  \tSTRPTIME(timestamp, '%Y%m%d-%H:%M:%S.%f')::timestamp AS msg_timestamp,\n  \tSTRPTIME('2023-03-09-09:30:05.063', '%Y-%m-%d-%H:%M:%S.%f')::timestamp as transact_time,\n  \tSTRPTIME(sending_time, '%Y%m%d-%H:%M:%S.%f')::timestamp AS sending_time,\n    msg_type,\n    cl_ord_id,\n    secondary_cl_ord_id,\n    order_id,\n    exec_id,\n    exec_type,\n    ord_status,\n    account,\n    symbol,\n    side,\n    currency,\n    try_cast(price AS double) AS price,\n    try_cast(quantity AS double) AS qty,\n    sender_comp_id,\n    target_comp_id,\n    time_in_force,\n    try_cast(checksum AS int) AS checksum,\n    try_cast(body_length AS int) AS body_length,\n    try_cast(msg_seq_num AS int) AS msg_seq_num,\n    begin_string,\n    filename,\n    system\n  FROM \"duckdb_pictet\".\"main_00_landing_fix\".\"fix_trading_raw\"\n)\n\nSELECT * FROM base", "relation_name": "\"duckdb_pictet\".\"main_01_staging_fix\".\"stg_fix_trading\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.920387Z", "completed_at": "2025-07-05T06:12:29.922267Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.922610Z", "completed_at": "2025-07-05T06:12:29.922613Z"}], "thread_id": "Thread-3", "execution_time": 0.0026559829711914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.file_integration", "compiled": true, "compiled_code": "-- intermediate/fix__int_order_metrics.sql\n\n\n select \n pg_txt_files.*,\n landing_fix.*\n from \n   \"duckdb_pictet\".\"main_00_landing_external\".\"postgres_processed_files\" as pg_txt_files\nLEFT join  \"duckdb_pictet\".\"main_00_landing_fix\".\"fix_trading_raw\" as landing_fix\n    on REPLACE(pg_txt_files.file_name,'.txt','') = REPLACE (REPLACE(landing_fix.filename,'.parquet',''),'s3://parquetfixlogs/','')", "relation_name": "\"duckdb_pictet\".\"main_000_monitoring\".\"file_integration\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.923237Z", "completed_at": "2025-07-05T06:12:29.924643Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.924804Z", "completed_at": "2025-07-05T06:12:29.924808Z"}], "thread_id": "Thread-2", "execution_time": 0.0019719600677490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.refine_fix_trading", "compiled": true, "compiled_code": "-- intermediate/fix__int_order_metrics.sql\n\n\nWITH enriched AS (\n  SELECT\n    *,\n    msg_timestamp - transact_time AS latency_interval,\n    ROW_NUMBER() OVER (PARTITION BY cl_ord_id ORDER BY msg_timestamp) = 1 AS is_first_msg\n  FROM \"duckdb_pictet\".\"main_01_staging_fix\".\"stg_fix_trading\"\n)\n\nSELECT * FROM enriched", "relation_name": "\"duckdb_pictet\".\"main_02_intermediate_fix\".\"refine_fix_trading\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.926985Z", "completed_at": "2025-07-05T06:12:29.932195Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.932426Z", "completed_at": "2025-07-05T06:12:29.932430Z"}], "thread_id": "Thread-1", "execution_time": 0.00687718391418457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.agg_kpi_analytics", "compiled": true, "compiled_code": "\n\nSELECT\n  sender_comp_id,\n  target_comp_id,\n  fix_trading_raw.msg_type,\n  fix_trading_raw.symbol,\n  dmt.msg_type_description,\n  COUNT(*) AS message_count\nFROM\n  \"duckdb_pictet\".\"main_02_intermediate_fix\".\"refine_fix_trading\" fix_trading_raw\nLEFT JOIN\n  \"duckdb_pictet\".\"main_03_analytics\".\"dim_fix_message_types\" dmt\n  ON fix_trading_raw.msg_type = dmt.msg_type\nGROUP BY\n  sender_comp_id,\n  target_comp_id,\n  fix_trading_raw.msg_type,\n  dmt.msg_type_description,\n  fix_trading_raw.symbol\nORDER BY\n  message_count DESC", "relation_name": "\"duckdb_pictet\".\"main_03_analytics\".\"agg_system_message_flow\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.928560Z", "completed_at": "2025-07-05T06:12:29.933071Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.933759Z", "completed_at": "2025-07-05T06:12:29.933762Z"}], "thread_id": "Thread-4", "execution_time": 0.007676839828491211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.agg_kpi_m1", "compiled": true, "compiled_code": "\n\nSELECT\n  DATE_TRUNC('minute', msg_timestamp) AS trading_minute,\n  COUNT(DISTINCT cl_ord_id) AS total_orders,\n  COUNT(CASE WHEN exec_type = 'F' THEN 1 END) AS execution_count,\n  COUNT(CASE WHEN ord_status = '8' THEN 1 END) * 1.0 / COUNT(*) AS reject_rate,\n  AVG(latency_interval) AS avg_latency,\n  COUNT(CASE WHEN checksum IS NULL OR checksum <= 0 THEN 1 END) AS invalid_checksums,\n  AVG(body_length) AS avg_body_length\nFROM \"duckdb_pictet\".\"main_02_intermediate_fix\".\"refine_fix_trading\"\nGROUP BY 1\nORDER BY 1", "relation_name": "\"duckdb_pictet\".\"main_03_KPI_fix\".\"agg_kpi_m1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.930957Z", "completed_at": "2025-07-05T06:12:29.933405Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.936079Z", "completed_at": "2025-07-05T06:12:29.936083Z"}], "thread_id": "Thread-2", "execution_time": 0.009474992752075195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.agg_kpi_system_level", "compiled": true, "compiled_code": "\n\n\nselect\n    sender_comp_id,\n    target_comp_id,\n    count(*) as nb_messages,\n    count(case when msg_type = 'D' then 1 end) as nb_orders,\n    count(case when msg_type = '8' then 1 end) as nb_exec_reports,\n    sum(try_cast(qty as double)) as volume_total,\n    avg(latency_interval) as avg_latency_ms\nfrom \"duckdb_pictet\".\"main_02_intermediate_fix\".\"refine_fix_trading\"\ngroup by sender_comp_id, target_comp_id", "relation_name": "\"duckdb_pictet\".\"main_03_KPI_fix\".\"agg_kpi_system_level\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.929725Z", "completed_at": "2025-07-05T06:12:29.933562Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.936326Z", "completed_at": "2025-07-05T06:12:29.936329Z"}], "thread_id": "Thread-3", "execution_time": 0.009899139404296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.agg_kpi_m1_sym", "compiled": true, "compiled_code": "\n\nSELECT\n  DATE_TRUNC('minute', msg_timestamp) AS trading_minute,\n  symbol,\n  COUNT(DISTINCT cl_ord_id) AS total_orders,\n  COUNT(CASE WHEN exec_type = 'F' THEN 1 END) AS execution_count,\n  COUNT(CASE WHEN ord_status = '8' THEN 1 END) * 1.0 / COUNT(*) AS reject_rate,\n  AVG(latency_interval) AS avg_latency,\n  COUNT(CASE WHEN checksum IS NULL OR checksum <= 0 THEN 1 END) AS invalid_checksums,\n  AVG(body_length) AS avg_body_length\nFROM \"duckdb_pictet\".\"main_02_intermediate_fix\".\"refine_fix_trading\"\nGROUP BY 1, 2\nORDER BY 1, 2", "relation_name": "\"duckdb_pictet\".\"main_03_KPI_fix\".\"agg_kpi_m1_sym\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-05T06:12:29.934022Z", "completed_at": "2025-07-05T06:12:29.936722Z"}, {"name": "execute", "started_at": "2025-07-05T06:12:29.936889Z", "completed_at": "2025-07-05T06:12:29.936892Z"}], "thread_id": "Thread-1", "execution_time": 0.004029989242553711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pictet_fix_project.fct_order_events", "compiled": true, "compiled_code": "\n\nSELECT\n  raw.msg_timestamp, \n  raw.account,\n  raw.symbol,\n  raw.side,\n  raw.cl_ord_id,\n  raw.order_id,\n  raw.exec_id,\n  raw.qty,          \n  raw.price,\n  raw.transact_time,\n  raw.sender_comp_id,\n  raw.target_comp_id,\n  raw.msg_type,\n  dmt.msg_type_description,\n  raw.ord_status,\n  dos_ord.status_value AS ord_status_description,\n  raw.exec_type,\n  dos_exec.status_value AS exec_type_description,\n  CASE\n    WHEN raw.exec_type = '2' THEN 'Executed'\n    WHEN raw.exec_type = '1' THEN 'Partially Filled'\n    WHEN raw.exec_type = '4' THEN 'Canceled'\n    WHEN raw.exec_type = '8' THEN 'Rejected'\n    -- You can add more specific categorization if needed\n    ELSE 'Other'\n  END AS event_category\nFROM\n  \"duckdb_pictet\".\"main_02_intermediate_fix\".\"refine_fix_trading\" raw -- Updated reference to the new staging model\nLEFT JOIN\n  \"duckdb_pictet\".\"main_03_analytics\".\"dim_fix_message_types\" dmt\n  ON raw.msg_type = dmt.msg_type\nLEFT JOIN\n  \"duckdb_pictet\".\"main_03_analytics\".\"dim_fix_order_statuses\" dos_ord\n  ON raw.ord_status = dos_ord.status_code AND dos_ord.tag_id = 39\nLEFT JOIN\n  \"duckdb_pictet\".\"main_03_analytics\".\"dim_fix_order_statuses\" dos_exec\n  ON raw.exec_type = dos_exec.status_code AND dos_exec.tag_id = 150\nWHERE\n  raw.msg_type = '8' -- Focus on Execution Reports for status updates\n  OR raw.msg_type = 'D' -- Also include New Order Singles for initial submission\nORDER BY\n  raw.msg_timestamp, raw.cl_ord_id", "relation_name": "\"duckdb_pictet\".\"main_03_analytics\".\"fct_order_events\"", "batch_results": null}], "elapsed_time": 0.1215980052947998, "args": {"require_all_warnings_handled_by_warn_error": false, "vars": {}, "show_resource_report": false, "log_path": "/Users/larcher/FIX_trading/dagster/deployments/fix_pipeline/pictet_fix_project/logs", "project_dir": "/Users/larcher/FIX_trading/dagster/deployments/fix_pipeline/pictet_fix_project", "log_format_file": "debug", "upload_to_artifacts_ingest_api": false, "which": "generate", "require_nested_cumulative_type_params": false, "target": "dev", "require_resource_names_without_spaces": true, "printer_width": 80, "indirect_selection": "eager", "use_colors": true, "log_level": "info", "state_modified_compare_more_unrendered_values": false, "cache_selected_only": false, "invocation_command": "dbt docs generate --profiles-dir .dbt --target dev", "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": true, "skip_nodes_if_on_run_start_fails": false, "use_fast_test_edges": false, "log_level_file": "debug", "state_modified_compare_vars": false, "macro_debugging": false, "partial_parse_file_diff": true, "select": [], "static": false, "profiles_dir": ".dbt", "log_file_max_bytes": 10485760, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "strict_mode": false, "introspect": true, "partial_parse": true, "write_json": true, "favor_state": false, "require_yaml_configuration_for_mf_time_spines": false, "compile": true, "send_anonymous_usage_stats": true, "empty_catalog": false, "version_check": true, "use_colors_file": true, "print": true, "log_format": "default", "warn_error_options": {"error": [], "warn": [], "silence": []}, "defer": false, "static_parser": true, "quiet": false, "show_all_deprecations": false, "validate_macro_args": false, "exclude": []}}